(this.webpackJsonpchess=this.webpackJsonpchess||[]).push([[0],{121:function(e,t,s){"use strict";s.r(t);var i=s(1),r=s.n(i),a=s(41),n=s.n(a),c=(s(47),s(48),s(0));class o extends r.a.Component{render(){return this.props.piece?Object(c.jsx)("div",{className:"square ".concat(this.props.cssClasses),onClick:this.props.onClick,children:Object(c.jsx)("img",{src:this.props.piece.image,alt:this.props.piece.name})}):Object(c.jsx)("div",{className:"square ".concat(this.props.cssClasses),onClick:this.props.onClick,children:Object(c.jsx)("span",{className:"sr-only",children:"empty square"})})}}class h extends r.a.Component{renderSquare(e){var t,s,i;let r=e.bgColor;return(null===(t=this.props.lastMove)||void 0===t?void 0:t.move_from)===e.index||(null===(s=this.props.lastMove)||void 0===s?void 0:s.move_to)===e.index?r="bg-orange":(null===(i=this.props.selectedSquare)||void 0===i?void 0:i.piece)===e.piece&&(r+=" border-blue"),this.props.checkmate?Object(c.jsx)(o,{piece:e.piece,cssClasses:r},e.index):Object(c.jsx)(o,{piece:e.piece,cssClasses:r,onClick:()=>this.props.onClick(e)},e.index)}render(){let e,t=[],s=0;for(var i=0;i<8;i++){let e=[];for(var r=0;r<8;r++)e.push(this.renderSquare(this.props.squares[s])),s+=1;t.push(Object(c.jsx)("div",{className:"row",children:e},i))}return this.props.checkmate&&(e=Object(c.jsx)("a",{href:"/",children:"Play again?"})),Object(c.jsxs)("div",{className:"board my-2",children:[t,Object(c.jsx)("p",{children:this.props.message}),e]})}}class l extends r.a.Component{displayGraveyard(){return this.props.graveyard.map((e,t)=>Object(c.jsx)("img",{src:e.image,alt:e.name,height:"20px",width:"20px"},"".concat(e.name,"-").concat(t)))}render(){return Object(c.jsxs)("div",{className:"player-card bg-white d-flex flex-column justify-content-between p-1 m-2",children:[Object(c.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(c.jsx)("h2",{className:"m-0 capitalize",children:this.props.player.color}),Object(c.jsx)("span",{className:"bg-grey p-1 white badge ".concat(this.props.current===this.props.player?"bg-blue":"bg-grey"),children:"Your turn"})]}),Object(c.jsx)("div",{className:"graveyard d-flex",children:this.displayGraveyard()})]})}}class u extends r.a.Component{displayMoveList(e){const t=[];let s,i;for(let a=0;a<e.length;a++){var r;s=e[a],i=null,a!==e.length-1&&(a+=1,i=e[a]),t.push(Object(c.jsx)("li",{children:Object(c.jsxs)("div",{className:"move-description",children:[Object(c.jsx)("span",{children:s.notation}),Object(c.jsx)("span",{children:null===(r=i)||void 0===r?void 0:r.notation})]})},a))}return t}render(){return Object(c.jsxs)("section",{className:"scoreboard h-100 d-flex flex-column justify-content-between",children:[Object(c.jsx)(l,{player:this.props.players.black,current:this.props.current,graveyard:this.props.whiteGraveyard}),Object(c.jsx)("div",{className:"h-100 p-2",children:Object(c.jsx)("div",{className:"move-history bg-white h-100 scrollable",children:Object(c.jsx)("ol",{className:"d-inline-block",children:this.displayMoveList(this.props.moves)})})}),Object(c.jsx)(l,{player:this.props.players.white,current:this.props.current,graveyard:this.props.blackGraveyard})]})}}class p{constructor(e,t){this.color=e,this.hasMoved=!1,this.image="".concat("/chessusingreactandjs","/").concat(t,"-").concat(e,".png"),this.name="".concat(e," ").concat(t)}pieceAtSquare(e,t){return e[t]&&e[t].piece}teamPieceAtSquare(e,t){return this.pieceAtSquare(e,t)&&e[t].piece.color===this.color}enemyPieceAtSquare(e,t){return this.pieceAtSquare(e,t)&&e[t].piece.color!==this.color}atLeftBorder(e){return e%8===0}atRightBorder(e){return(e+1)%8===0}atTopBorder(e){return e<8}atBottomBorder(e){return e>55}}class d extends p{constructor(e){super(e,"knight"),this.className="Knight"}possibleMoves(e,t){const s=[];let i;return this.canMoveUp(t,2)&&(i=t-17,this.canMoveLeft(t,1)&&!this.teamPieceAtSquare(e,i)&&s.push(i),i=t-15,this.canMoveRight(t,1)&&!this.teamPieceAtSquare(e,i)&&s.push(i)),this.canMoveUp(t,1)&&(i=t-10,this.canMoveLeft(t,2)&&!this.teamPieceAtSquare(e,i)&&s.push(i),i=t-6,this.canMoveRight(t,2)&&!this.teamPieceAtSquare(e,i)&&s.push(i)),this.canMoveDown(t,2)&&(i=t+15,this.canMoveLeft(t,1)&&!this.teamPieceAtSquare(e,i)&&s.push(i),i=t+17,this.canMoveRight(t,1)&&!this.teamPieceAtSquare(e,i)&&s.push(i)),this.canMoveDown(t,1)&&(i=t+6,this.canMoveLeft(t,2)&&!this.teamPieceAtSquare(e,i)&&s.push(i),i=t+10,this.canMoveRight(t,2)&&!this.teamPieceAtSquare(e,i)&&s.push(i)),s}canMoveUp(e){return 2===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)?e>15:e>7}canMoveLeft(e){return 2===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)?(e-1)%8!==0&&e%8!==0:e%8!==0}canMoveRight(e){return 2===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)?(e+2)%8!==0&&(e+1)%8!==0:(e+1)%8!==0}canMoveDown(e){return 2===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:2)?e<48:e<56}}class m extends p{constructor(e){super(e,"bishop"),this.className="Bishop"}possibleMoves(e,t){const s=[];let i;for(i=t;!this.atLeftBorder(i)&&!this.atTopBorder(i);){if(i-=9,this.enemyPieceAtSquare(e,i)){s.push(i);break}if(this.pieceAtSquare(e,i))break;s.push(i)}for(i=t;!this.atRightBorder(i)&&!this.atTopBorder(i);){if(i-=7,this.enemyPieceAtSquare(e,i)){s.push(i);break}if(this.pieceAtSquare(e,i))break;s.push(i)}for(i=t;!this.atLeftBorder(i)&&!this.atBottomBorder(i);){if(i+=7,this.enemyPieceAtSquare(e,i)){s.push(i);break}if(this.pieceAtSquare(e,i))break;s.push(i)}for(i=t;!this.atRightBorder(i)&&!this.atBottomBorder(i);){if(i+=9,this.enemyPieceAtSquare(e,i)){s.push(i);break}if(this.pieceAtSquare(e,i))break;s.push(i)}return s}}class v extends p{constructor(e){super(e,"king"),this.className="King"}possibleMoves(e,t){const s=[];let i;return this.atTopBorder(t)||(i=t-8,this.teamPieceAtSquare(e,i)||s.push(i),i=t-9,this.atLeftBorder(t)||this.teamPieceAtSquare(e,i)||s.push(i),i=t-7,this.atRightBorder(t)||this.teamPieceAtSquare(e,i)||s.push(i)),i=t-1,this.atLeftBorder(t)||this.teamPieceAtSquare(e,i)||s.push(i),i=t+1,this.atRightBorder(t)||this.teamPieceAtSquare(e,i)||s.push(i),this.atBottomBorder(t)||(i=t+8,this.teamPieceAtSquare(e,i)||s.push(i),i=t+7,this.atLeftBorder(t)||this.teamPieceAtSquare(e,i)||s.push(i),i=t+9,this.atRightBorder(t)||this.teamPieceAtSquare(e,i)||s.push(i)),s}}class w extends p{constructor(e,t){super(e,"queen"),this.className="Queen"}possibleMoves(e,t){const s=[];let i,r=1,a=!this.atTopBorder(t),n=!this.atLeftBorder(t),c=!this.atRightBorder(t);for(;this.indexAtCenter(t,r,"up")>=0;)n&&(i=this.indexAtLeftDiagonal(t,r,"up"),this.enemyPieceAtSquare(e,i)?(s.push(i),n=!1):this.pieceAtSquare(e,i)?n=!1:this.atLeftBorder(i)?(s.push(i),n=!1):s.push(i)),a&&(i=this.indexAtCenter(t,r,"up"),this.enemyPieceAtSquare(e,i)?(s.push(i),a=!1):this.pieceAtSquare(e,i)?a=!1:this.atTopBorder(i)?(s.push(i),a=!1):s.push(i)),c&&(i=this.indexAtRightDiagonal(t,r,"up"),this.enemyPieceAtSquare(e,i)?(s.push(i),c=!1):this.pieceAtSquare(e,i)?c=!1:this.atRightBorder(i)?(s.push(i),c=!1):s.push(i)),r+=1;for(r=1,a=!this.atBottomBorder(t),n=!this.atLeftBorder(t),c=!this.atRightBorder(t);this.indexAtCenter(t,r,"down")<64;)n&&(i=this.indexAtLeftDiagonal(t,r,"down"),this.enemyPieceAtSquare(e,i)?(s.push(i),n=!1):this.pieceAtSquare(e,i)?n=!1:this.atLeftBorder(i)?(s.push(i),n=!1):s.push(i)),a&&(i=this.indexAtCenter(t,r,"down"),this.enemyPieceAtSquare(e,i)?(s.push(i),a=!1):this.pieceAtSquare(e,i)?a=!1:this.atBottomBorder(i)?(s.push(i),a=!1):s.push(i)),c&&(i=this.indexAtRightDiagonal(t,r,"down"),this.enemyPieceAtSquare(e,i)?(s.push(i),c=!1):this.pieceAtSquare(e,i)?c=!1:this.atRightBorder(i)?(s.push(i),c=!1):s.push(i)),r+=1;r=1;let o=!this.atLeftBorder(t),h=!this.atRightBorder(t);for(;o||h;)o&&(i=t-r,this.enemyPieceAtSquare(e,i)?(s.push(i),o=!1):this.pieceAtSquare(e,i)?o=!1:this.atLeftBorder(i)?(s.push(i),o=!1):s.push(i)),h&&(i=t+r,this.enemyPieceAtSquare(e,i)?(s.push(i),h=!1):this.pieceAtSquare(e,i)?h=!1:this.atRightBorder(i)?(s.push(i),h=!1):s.push(i)),r+=1;return s}indexAtCenter(e,t,s){return"up"===s?e-8*t:"down"===s?e+8*t:void 0}indexAtLeftDiagonal(e,t,s){return"up"===s?e-8*t-t:"down"===s?e+8*t-t:void 0}indexAtRightDiagonal(e,t,s){return"up"===s?e-8*t+t:"down"===s?e+8*t+t:void 0}}class b extends p{constructor(e,t){super(e,"rook"),this.className="Rook"}possibleMoves(e,t){const s=[];let i;for(i=t-8;i>=0;){if(this.enemyPieceAtSquare(e,i)){s.push(i);break}if(this.pieceAtSquare(e,i))break;s.push(i),i-=8}for(i=t+8;i<64;){if(this.enemyPieceAtSquare(e,i)){s.push(i);break}if(this.pieceAtSquare(e,i))break;s.push(i),i+=8}for(i=t;i%8!==0;){if(i-=1,this.enemyPieceAtSquare(e,i)){s.push(i);break}if(this.pieceAtSquare(e,i))break;s.push(i)}for(i=t;(i+1)%8!==0;){if(i+=1,this.enemyPieceAtSquare(e,i)){s.push(i);break}if(this.pieceAtSquare(e,i))break;s.push(i)}return s}}class g extends p{constructor(e){super(e,"pawn"),this.className="Pawn"}possibleMoves(e,t){const s=[];let i,r="white"===this.color?-8:8;return i=t+r,this.pieceAtSquare(e,i)||(s.push(i),i+=r,this.hasMoved||this.pieceAtSquare(e,i)||s.push(i)),i=t+r-1,this.enemyPieceAtSquare(e,i)&&s.push(i),i=t+r+1,this.enemyPieceAtSquare(e,i)&&s.push(i),s}inFifthRank(e){return"black"===this.color?[32,33,34,35,36,37,38,39].includes(e):[24,25,26,27,28,29,30,31].includes(e)}}class f{constructor(){this.moves=[]}logMove(e){return e.notation=this.translateToChessNotation(e),this.moves.push(e),e}lastMove(){return this.moves[this.moves.length-1]}translateToChessNotation(e){let t,s,i,r,a,n;return e.castle?e.move_to>e.move_from?"0-0":"0-0-0":(t={Pawn:"",King:"K",Queen:"Q",Bishop:"B",Knight:"N",Rook:"R"}[e.piece.className],i=this.getColumn(e.move_to),r=this.getRow(e.move_to),n=e.checkmate?"#":e.check?"+":"",e.capture&&"Pawn"===e.piece.className?(s=this.getColumn(e.move_from),s+="x"):s=e.capture?"x":"",a=e.promotion?"=Q":"","".concat(t).concat(s).concat(i).concat(r).concat(a).concat(n))}getColumn(e){return e%8===0?"a":(e-1)%8===0?"b":(e-2)%8===0?"c":(e-3)%8===0?"d":(e-4)%8===0?"e":(e-5)%8===0?"f":(e-6)%8===0?"g":"h"}getRow(e){return e<8?"8":e<16?"7":e<24?"6":e<32?"5":e<40?"4":e<48?"3":e<56?"2":"1"}}class x{constructor(e){this.color=e}}class k{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.index=8*e+t,this.row=e,this.column=t,this.piece=s,this.bgColor=this.defaultBgColor()}defaultBgColor(){return this.row%2===0?this.column%2===0?"bg-dark":"bg-light":this.column%2===0?"bg-light":"bg-dark"}possibleMoves(e){return!!this.piece&&this.piece.possibleMoves(e,this.index)}}var q=s(42),j=s.n(q);class S extends r.a.Component{constructor(e){super(e);const t=this.setPlayers();this.state={squares:this.initializeBoard(),message:"Welcome! White's turn.",players:t,current:t.white,selectedSquare:null,whiteGraveyard:[],blackGraveyard:[],history:new f,check:!1,checkmate:!1}}initializeBoard(){let e=Array(64).fill(null);e[0]=new k(0,0,new b("black")),e[1]=new k(0,1,new d("black")),e[2]=new k(0,2,new m("black")),e[3]=new k(0,3,new w("black")),e[4]=new k(0,4,new v("black")),e[5]=new k(0,5,new m("black")),e[6]=new k(0,6,new d("black")),e[7]=new k(0,7,new b("black")),e[8]=new k(1,0,new g("black")),e[9]=new k(1,1,new g("black")),e[10]=new k(1,2,new g("black")),e[11]=new k(1,3,new g("black")),e[12]=new k(1,4,new g("black")),e[13]=new k(1,5,new g("black")),e[14]=new k(1,6,new g("black")),e[15]=new k(1,7,new g("black"));let t=16;for(let s=2;s<6;s++)for(let i=0;i<8;i++)e[t]=new k(s,i),t+=1;return e[56]=new k(7,0,new b("white")),e[57]=new k(7,1,new d("white")),e[58]=new k(7,2,new m("white")),e[59]=new k(7,3,new w("white")),e[60]=new k(7,4,new v("white")),e[61]=new k(7,5,new m("white")),e[62]=new k(7,6,new d("white")),e[63]=new k(7,7,new b("white")),e[48]=new k(6,0,new g("white")),e[49]=new k(6,1,new g("white")),e[50]=new k(6,2,new g("white")),e[51]=new k(6,3,new g("white")),e[52]=new k(6,4,new g("white")),e[53]=new k(6,5,new g("white")),e[54]=new k(6,6,new g("white")),e[55]=new k(6,7,new g("white")),e}pieces(e,t){const s=[];for(let i=0;i<e.length;i++)e[i].piece&&e[i].piece.color===t&&s.push(e[i]);return s}setPlayers(){let e={};return e.white=new x("white"),e.black=new x("black"),e}validateMove(e,t){return e.possibleMoves(this.state.squares).includes(t.index)&&!this.check(this.previewMove(e,t),this.state.current)}previewMove(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.squares,i=j()(s);return i[t.index].piece=e.piece,i[e.index].piece=null,i}validateSelectedSquare(e){var t;return(null===(t=e.piece)||void 0===t?void 0:t.color)===this.state.current.color}handleClick(e){let t=this.state.selectedSquare;return this.validateSelectedSquare(e)?this.selectSquare(e):t&&this.validateMove(t,e)?this.movePiece(t,e):t&&this.canCastle(t,e)?this.movePiece(t,e,{castle:!0}):t&&this.canEnPassant(t,e)?this.movePiece(t,e,{enpassant:!0}):t?this.setState(e=>({message:"You cannot move there."})):this.setState(e=>({message:"Please select one of the ".concat(this.state.current.color," pieces to move.")}))}movePiece(e,t){var s,i;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=this.state.history,n=this.state.current,c=this.state.squares,o=this.state.blackGraveyard,h=this.state.whiteGraveyard,l=!1,u=!1;if("white"===(null===(s=t.piece)||void 0===s?void 0:s.color)?(h.push(t.piece),l=!0):"black"===(null===(i=t.piece)||void 0===i?void 0:i.color)&&(o.push(t.piece),l=!0),r.castle){let s=this.getCastlingRook(e,t);e.index>t.index?(c[t.index+1].piece=s.piece,s.piece=null):(c[t.index-1].piece=s.piece,s.piece=null)}if(r.enpassant){let s=this.getEnPassantPawn(e,t);"white"===s.piece.color?(h.push(s.piece),l=!0):"black"===s.piece.color&&(o.push(s.piece),l=!0),s.piece=null}t.piece=e.piece,e.piece=null,t.piece.hasMoved=!0,this.promotion(t)&&(u=!0,t.piece=new w(n.color));let p="white"===n.color?this.state.players.black:this.state.players.white,d=this.check(c,p),m=!1;d&&(m=this.checkmate(c,p));let v="".concat(p.color,"'s turn. Please select a piece to move.");m&&(v="Checkmate! Congrats to ".concat(n.color,". You won!")),a.logMove({current:n,piece:t.piece,move_to:t.index,move_from:e.index,check:d,checkmate:m,capture:l,promotion:u,castle:r.castle,enpassant:r.enpassant}),this.setState(e=>({squares:c,current:p,message:v,selectedSquare:null,history:a,blackGraveyard:o,whiteGraveyard:h,check:d,checkmate:m}))}selectSquare(e){this.setState(t=>({message:"Select where to move ".concat(e.piece.name),selectedSquare:e}))}check(e,t){let s=e.find(e=>{var s;return(null===(s=e.piece)||void 0===s?void 0:s.name)==="".concat(t.color," king")}),i=this.pieces(e,"white"===t.color?"black":"white");for(let r=0;r<i.length;r++){if(i[r].possibleMoves(e).includes(s.index))return!0}return!1}checkmate(e,t){let s=this.pieces(e,t.color);for(let i=0;i<s.length;i++){let r=s[i],a=r.possibleMoves(e);for(let s=0;s<a.length;s++){let i=a[s];if(!this.check(this.previewMove(r,e[i],e),t))return!1}}return!0}promotion(e){if("Pawn"!==e.piece.className)return!1;if("black"===e.piece.color){if(7===e.row)return!0}else if(0===e.row)return!0;return!1}canEnPassant(e,t){var s,i;let r=this.getEnPassantPawn(e,t),a=this.state.history.lastMove();if("Pawn"!==e.piece.className)return!1;if(!e.piece.inFifthRank(e.index))return!1;if("black"===e.piece.color){if(t.index!==e.index+9&&t.index!==e.index+7)return!1}else if(t.index!==e.index-9&&t.index!==e.index-7)return!1;return(null===(s=r.piece)||void 0===s?void 0:s.color)!==e.piece.color&&("Pawn"===(null===(i=r.piece)||void 0===i?void 0:i.className)&&(a.move_to===r.index&&16===Math.abs(a.move_from-a.move_to)))}canCastle(e,t){if("King"!==e.piece.className)return!1;if(e.piece.hasMoved)return!1;if("black"===e.piece.color){if(![2,6].includes(t.index))return!1}else if(![58,62].includes(t.index))return!1;if(this.check(this.state.squares,this.state.current))return!1;let s=this.getCastlingRook(e,t);if(s.piece.hasMoved)return!1;let i=this.squaresBetweenLocations(e,s);for(let n=0;n<i.length;n++)if(i[n].piece)return!1;let r=this.squaresBetweenLocations(e,t),a=this.pieces(this.state.squares,"white"===this.state.current.color?"black":"white");for(let n=0;n<a.length;n++){let e=a[n].possibleMoves(this.state.squares);for(let t=0;t<r.length;t++)if(e.includes(r[t]))return!1;if(e.includes(t.index))return!1}return!0}getCastlingRook(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.squares;return t.index>e.index?"black"===e.piece.color?s[7]:s[63]:"black"===e.piece.color?s[0]:s[56]}getEnPassantPawn(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.squares;return"black"===e.piece.color?s[t.index-8]:s[t.index+8]}squaresBetweenLocations(e,t){const s=[];if(e.index>t.index)for(let i=t.index+1;i<e.index;i++)s.push(this.state.squares[i]);else for(let i=e.index+1;i<t.index;i++)s.push(this.state.squares[i]);return s}render(){return Object(c.jsxs)("main",{className:"container vw-100 vh-100",children:[Object(c.jsx)(u,{players:this.state.players,current:this.state.current,moves:this.state.history.moves,whiteGraveyard:this.state.whiteGraveyard,blackGraveyard:this.state.blackGraveyard}),Object(c.jsx)(h,{squares:this.state.squares,checkmate:this.state.checkmate,message:this.state.message,selectedSquare:this.state.selectedSquare,lastMove:this.state.history.lastMove(),onClick:e=>this.handleClick(e)})]})}}var y=function(){return Object(c.jsxs)("div",{className:"app",children:[Object(c.jsx)("header",{className:"bg-black p-2 white",children:Object(c.jsx)("nav",{className:"d-grid nav-grid align-items-center",children:Object(c.jsx)("div",{className:"d-flex justify-content-center",children:Object(c.jsx)("h1",{className:"m-0",children:"Chess"})})})}),Object(c.jsx)(S,{})]})};var A=e=>{e&&e instanceof Function&&s.e(3).then(s.bind(null,122)).then(t=>{let{getCLS:s,getFID:i,getFCP:r,getLCP:a,getTTFB:n}=t;s(e),i(e),r(e),a(e),n(e)})};n.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(y,{})}),document.getElementById("root")),A()},47:function(e,t,s){},48:function(e,t,s){}},[[121,1,2]]]);
//# sourceMappingURL=main.2674743e.chunk.js.map